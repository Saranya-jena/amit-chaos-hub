"{\n    \"kind\": \"Workflow\",\n    \"apiVersion\": \"argoproj.io/v1alpha1\",\n    \"metadata\": {\n        \"name\": \"lambda-delete-function-concurrency\",\n        \"namespace\": \"litmus\",\n        \"creationTimestamp\": null,\n        \"labels\": {\n            \"subject\": \"lambda-delete-function-concurrency\"\n        }\n    },\n    \"spec\": {\n        \"templates\": [\n            {\n                \"name\": \"custom-chaos\",\n                \"steps\": [\n                    [\n                        {\n                            \"name\": \"install-chaos-faults\",\n                            \"template\": \"install-chaos-faults\"\n                        }\n                    ],\n                    [\n                        {\n                            \"name\": \"lambda-delete-function-concurrency-mgk\",\n                            \"template\": \"lambda-delete-function-concurrency-mgk\"\n                        }\n                    ],\n                    [\n                        {\n                            \"name\": \"cleanup-chaos-resources\",\n                            \"template\": \"cleanup-chaos-resources\"\n                        }\n                    ]\n                ]\n            },\n            {\n                \"name\": \"install-chaos-faults\",\n                \"inputs\": {\n                    \"artifacts\": [\n                        {\n                            \"name\": \"lambda-delete-function-concurrency-mgk\",\n                            \"path\": \"/tmp/lambda-delete-function-concurrency-mgk.yaml\",\n                            \"raw\": {\n                                \"data\": \"apiVersion: litmuschaos.io/v1alpha1\\ndescription:\\n  message: |\\n    Inject AWS lambda delete function concurrency chaos for a certain chaos duration\\nkind: ChaosExperiment\\nmetadata:\\n  name: lambda-delete-function-concurrency\\n  labels:\\n    name: lambda-delete-function-concurrency\\n    app.kubernetes.io/part-of: litmus\\n    app.kubernetes.io/component: chaosexperiment\\n    app.kubernetes.io/version: ci\\nspec:\\n  definition:\\n    scope: Cluster\\n    permissions:\\n      - apiGroups:\\n          - \\\"\\\"\\n        resources:\\n          - pods\\n        verbs:\\n          - create\\n          - delete\\n          - get\\n          - list\\n          - patch\\n          - update\\n          - deletecollection\\n      - apiGroups:\\n          - \\\"\\\"\\n        resources:\\n          - events\\n        verbs:\\n          - create\\n          - get\\n          - list\\n          - patch\\n          - update\\n      - apiGroups:\\n          - \\\"\\\"\\n        resources:\\n          - secrets\\n          - configmaps\\n        verbs:\\n          - get\\n          - list\\n      - apiGroups:\\n          - \\\"\\\"\\n        resources:\\n          - pods/log\\n        verbs:\\n          - get\\n          - list\\n          - watch\\n      - apiGroups:\\n          - \\\"\\\"\\n        resources:\\n          - pods/exec\\n        verbs:\\n          - get\\n          - list\\n          - create\\n      - apiGroups:\\n          - batch\\n        resources:\\n          - jobs\\n        verbs:\\n          - create\\n          - list\\n          - get\\n          - delete\\n          - deletecollection\\n      - apiGroups:\\n          - litmuschaos.io\\n        resources:\\n          - chaosengines\\n          - chaosexperiments\\n          - chaosresults\\n        verbs:\\n          - create\\n          - list\\n          - get\\n          - patch\\n          - update\\n          - delete\\n      - apiGroups:\\n          - \\\"\\\"\\n        resources:\\n          - nodes\\n        verbs:\\n          - get\\n          - list\\n    image: chaosnative/chaos-go-runner:main-latest\\n    imagePullPolicy: Always\\n    args:\\n      - -c\\n      - ./experiments -name lambda-delete-function-concurrency\\n    command:\\n      - /bin/bash\\n    env:\\n    - name: TOTAL_CHAOS_DURATION\\n      value: '30'\\n    - name: CHAOS_INTERVAL\\n      value: '30'\\n    - name: RAMP_TIME\\n      value: ''\\n    - name: FUNCTION_NAME\\n      value: ''\\n    - name: FUNCTION_VERSION\\n      value: '$LATEST'\\n    - name: REGION\\n      value: ''\\n    - name: AWS_SHARED_CREDENTIALS_FILE\\n      value: '/tmp/cloud_config.yml'\\n    labels:\\n      name: lambda-delete-function-concurrency\\n      app.kubernetes.io/part-of: litmus\\n      app.kubernetes.io/component: experiment-job\\n      app.kubernetes.io/version: ci\\n    secrets:\\n      - name: cloud-secret\\n        mountPath: /tmp/\\n\"\n                            }\n                        }\n                    ]\n                },\n                \"container\": {\n                    \"name\": \"\",\n                    \"image\": \"docker.io/chaosnative/k8s:1.15.0\",\n                    \"command\": [\n                        \"sh\",\n                        \"-c\"\n                    ],\n                    \"args\": [\n                        \"kubectl apply -f /tmp/ -n {{workflow.parameters.adminModeNamespace}} && sleep 30\"\n                    ]\n                }\n            },\n            {\n                \"name\": \"lambda-delete-function-concurrency-mgk\",\n                \"inputs\": {\n                    \"artifacts\": [\n                        {\n                            \"name\": \"lambda-delete-function-concurrency-mgk\",\n                            \"path\": \"/tmp/chaosengine-lambda-delete-function-concurrency-mgk.yaml\",\n                            \"raw\": {\n                                \"data\": \"apiVersion: litmuschaos.io/v1alpha1\\nkind: ChaosEngine\\nmetadata:\\n  namespace: \\\"{{workflow.parameters.adminModeNamespace}}\\\"\\n  generateName: lambda-delete-function-concurrency-mgk\\n  labels:\\n    instance_id: 3b589183-7d6f-402c-835c-6a0638c00b96\\n    workflow_name: lambda-delete-function-concurrency\\nspec:\\n  engineState: active\\n  chaosServiceAccount: litmus-admin\\n  experiments:\\n    - name: lambda-delete-function-concurrency\\n      spec:\\n        components:\\n          env:\\n            - name: TOTAL_CHAOS_DURATION\\n              value: '30'\\n            - name: CHAOS_INTERVAL\\n              value: '30'\\n            - name: FUNCTION_NAME\\n              value: ''\\n            - name: FUNCTION_VERSION\\n              value: '$LATEST'\\n            - name: REGION\\n              value: ''\\n        probe:\\n          - name: healthcheck\\n            type: cmdProbe\\n            mode: Edge\\n            runProperties:\\n              probeTimeout: 5s\\n              retry: 0\\n              interval: 1s\\n              stopOnFailure: false\\n            cmdProbe/inputs:\\n              command: ./healthcheck -name lambda-delete-function-concurrency\\n              source:\\n                image: chaosnative/chaos-go-runner:main-latest\\n                inheritInputs: true\\n              comparator:\\n                type: string\\n                criteria: contains\\n                value: \\\"[P000]\\\"\\n\"\n                            }\n                        }\n                    ]\n                },\n                \"metadata\": {\n                    \"labels\": {\n                        \"weight\": \"10\"\n                    }\n                },\n                \"container\": {\n                    \"name\": \"\",\n                    \"image\": \"docker.io/chaosnative/litmus-checker:1.15.0\",\n                    \"args\": [\n                        \"-file=/tmp/chaosengine-lambda-delete-function-concurrency-mgk.yaml\",\n                        \"-saveName=/tmp/engine-name\"\n                    ]\n                }\n            },\n            {\n                \"name\": \"cleanup-chaos-resources\",\n                \"container\": {\n                    \"name\": \"\",\n                    \"image\": \"docker.io/chaosnative/k8s:1.15.0\",\n                    \"command\": [\n                        \"sh\",\n                        \"-c\"\n                    ],\n                    \"args\": [\n                        \"kubectl delete chaosengine -l 'instance_id in (3b589183-7d6f-402c-835c-6a0638c00b96, )' -n {{workflow.parameters.adminModeNamespace}} \"\n                    ]\n                }\n            }\n        ],\n        \"entrypoint\": \"custom-chaos\",\n        \"arguments\": {\n            \"parameters\": [\n                {\n                    \"name\": \"adminModeNamespace\",\n                    \"value\": \"litmus\"\n                }\n            ]\n        },\n        \"serviceAccountName\": \"argo-chaos\",\n        \"podGC\": {\n            \"strategy\": \"OnWorkflowCompletion\"\n        },\n        \"securityContext\": {\n            \"runAsUser\": 1000,\n            \"runAsNonRoot\": true\n        }\n    }\n}"
